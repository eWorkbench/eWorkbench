<!--
  Copyright (C) 2016-2020 TU Muenchen and contributors of ANEXIA Internetdienstleistungs GmbH
  SPDX-License-Identifier: AGPL-3.0-or-later
-->

<ng-container *transloco="let t">
  <eworkbench-loading [loading]="loading">
    <div class="link-tools mb-2 text-right">
      <ng-select
        class="ewb-select d-inline-block text-left"
        [placeholder]="t('linkList.filterLinks')"
        [items]="contentTypes"
        (change)="onChangeFilterContentType($event)"
      ></ng-select>
    </div>
    <eworkbench-table-manage-columns
      class="d-flex justify-content-end mb-3"
      [columns]="listColumns"
      [reset]="false"
      (columnsChanged)="onColumnsChanged($event)"
    ></eworkbench-table-manage-columns>
    <eworkbench-table-view
      #tableView
      [data]="relations"
      [columns]="listColumns"
      [pagination]="false"
      (sortChanged)="onSortChanged($event)"
    ></eworkbench-table-view>
  </eworkbench-loading>
</ng-container>

<ng-template #relationNameCellTemplate let-row>
  <eworkbench-icon [className]="row.left_content_object.content_type_model | formatContentTypeModel: 'icon'" class="mr-2"></eworkbench-icon>
  <a [routerLink]="[row.left_content_object.content_type_model | formatContentTypeModel: 'routerBaseLink', row.left_content_object.pk]">{{
    row.left_content_object.display
  }}</a>
</ng-template>
<ng-template #typeCellTemplate let-row>
  {{ row.left_content_object.content_type_model | formatContentTypeModel }}
</ng-template>
<ng-template #linkedByCellTemplate let-row>
  <eworkbench-user-details [user]="row.created_by"></eworkbench-user-details>
</ng-template>
<ng-template #linkedAtCellTemplate let-row>
  {{ row.created_at | formatDate }}
</ng-template>
<ng-template #actionsCellTemplate let-row>
  <ng-container *transloco="let t">
    <div class="text-right" *ngIf="currentUser?.pk === row.created_by.pk">
      <button type="button" class="btn ewb-button-small mr-2" (click)="onChangePrivateState(row)" [disabled]="loading">
        <eworkbench-icon
          *ngIf="row.private"
          className="wb-locked"
          [tooltip]="t('linkList.privateLink.tooltip')"
          containerClass="tooltip-sm"
        ></eworkbench-icon>
        <eworkbench-icon
          *ngIf="!row.private"
          className="wb-unlock"
          [tooltip]="t('linkList.publicLink.tooltip')"
          containerClass="tooltip-sm"
        ></eworkbench-icon>
      </button>
      <button type="button" class="btn ewb-button-small" (click)="onOpenDeleteModal(row)" [disabled]="loading">
        <eworkbench-icon className="wb-trash-1" [tooltip]="t('linkList.deleteLink.tooltip')" containerClass="tooltip-sm"></eworkbench-icon>
      </button>
    </div>
  </ng-container>
</ng-template>
