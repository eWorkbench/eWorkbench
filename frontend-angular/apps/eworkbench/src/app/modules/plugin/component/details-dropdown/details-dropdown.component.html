<!--
  Copyright (C) 2016-2020 TU Muenchen and contributors of ANEXIA Internetdienstleistungs GmbH
  SPDX-License-Identifier: AGPL-3.0-or-later
-->

<ng-container *transloco="let t">
  <div id="plugin-details-dropdown">
    <div *ngIf="dropdown" class="inline-block h-full navbar-nav" dropdown container="#plugin-details-dropdown" placement="bottom right">
      <button
        type="button"
        [id]="'plugin-details-dropdown-button' + plugin.pk"
        class="btn ewb-button-big ewb-button-background square-md"
        aria-controls="details-dropdown-menu"
        dropdownToggle
      >
        <eworkbench-icon className="wb-more-vertical"></eworkbench-icon>
      </button>
      <ul
        id="plugin-details-dropdown-menu"
        *dropdownMenu
        class="dropdown-menu dropdown-menu-right details-dropdown-menu"
        role="menu"
        [attr.aria-labelledby]="'plugin-details-dropdown-button' + plugin.pk"
      >
        <ng-template
          *ngTemplateOutlet="
            dropdownUL;
            context: {
              t: t,
              menuClass: '',
              itemClass: 'btn ewb-button-regular font-weight-normal w-100 text-left menu-item-button'
            }
          "
        ></ng-template>
      </ul>
    </div>
    <div *ngIf="!dropdown" class="inline-block w-full navbar-nav">
      <button
        type="button"
        class="btn ewb-button-big ewb-button-background square-md"
        [attr.aria-expanded]="!detailsCollapsed"
        aria-controls="collapseBasic"
        (click)="detailsCollapsed = !detailsCollapsed"
      >
        <eworkbench-icon className="wb-more-vertical"></eworkbench-icon>
      </button>
      <div class="collapse navbar-collapse mt-1 py-2 bg-white" [collapse]="detailsCollapsed">
        <ng-template
          *ngTemplateOutlet="
            dropdownUL;
            context: {
              t: t,
              menuClass: 'menuitem',
              itemClass: 'btn ewb-button-regular font-weight-normal w-100 text-left menu-item-button'
            }
          "
        ></ng-template>
      </div>
    </div>
  </div>
</ng-container>

<ng-template #dropdownUL let-t="t" let-menuClass="menuClass" let-itemClass="itemClass">
  <li [class]="menuClass" role="menuitem">
    <button type="button" [class]="itemClass" (click)="onGiveFeedback()">
      <eworkbench-icon className="wb-envelope"></eworkbench-icon> {{ t('plugin.detailsDropdown.giveFeedback') }}
    </button>
  </li>
  <li [class]="menuClass" role="menuitem" *ngIf="!plugin.is_accessible">
    <button type="button" [class]="itemClass" (click)="onRequestAccess()">
      <eworkbench-icon className="wb-envelope"></eworkbench-icon> {{ t('plugin.detailsDropdown.requestAccess') }}
    </button>
  </li>
</ng-template>
