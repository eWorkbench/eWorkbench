<!--
  Copyright (C) 2016-2020 TU Muenchen and contributors of ANEXIA Internetdienstleistungs GmbH
  SPDX-License-Identifier: AGPL-3.0-or-later
-->

<ng-container *transloco="let t">
  <eworkbench-header [title]="title">
    <ng-container slot="search">
      <div class="flex items-center">
        <div class="search-input mr-2">
          <div class="input-group search-input-group">
            <input
              type="text"
              class="form-control ewb-input"
              id="search-header"
              name="search-header"
              [formControl]="searchControl"
              [placeholder]="t('dssContainers.header.search.placeholder')"
            />
            <button type="button" class="btn btn-sm bg-transparent clear-input" *ngIf="!searchControl.value">
              <eworkbench-icon className="wb-search"></eworkbench-icon>
            </button>
            <button
              type="button"
              class="btn btn-sm bg-transparent clear-input"
              (click)="searchControl.patchValue(null)"
              *ngIf="searchControl.value"
            >
              <eworkbench-icon className="wb-remove"></eworkbench-icon>
            </button>
          </div>
        </div>
      </div>
    </ng-container>
    <ng-container slot="elements">
      <button class="btn ewb-button-big ewb-button-background" (click)="openNewModal()">
        <eworkbench-icon className="wb-plus-circle"></eworkbench-icon> {{ t('dssContainers.new') }}
      </button>
    </ng-container>
  </eworkbench-header>
</ng-container>

<main>
  <eworkbench-collapse-element *ngIf="dssContainerListHowTo" class="mb-4" [labelText]="dssContainerListHowTo?.title" [collapsed]="true">
    <div [innerHTML]="dssContainerListHowTo?.text | safeHTML"></div>
  </eworkbench-collapse-element>

  <eworkbench-table-manage-columns
    class="flex justify-end mb-4"
    [columns]="listColumns"
    [defaultColumns]="defaultColumns"
    (columnsChanged)="onColumnsChanged($event)"
  ></eworkbench-table-manage-columns>
  <eworkbench-table-view #tableView [columns]="listColumns" [service]="dssContainersService"></eworkbench-table-view>

  <ng-template #nameCellTemplate let-row>
    <div ellipsis [tooltip]="row.name" containerClass="tooltip-sm" [delay]="500">
      <a [routerLink]="['/dsscontainers', row.pk]">{{ row.name }}</a>
    </div>
  </ng-template>
  <ng-template #pathCellTemplate let-row>
    {{ row.path }}
  </ng-template>
  <ng-template #readWriteSettingCellTemplate let-row>
    <eworkbench-dss-read-write-setting [readWriteSetting]="row.read_write_setting"></eworkbench-dss-read-write-setting>
  </ng-template>
  <ng-template #importOptionCellTemplate let-row>
    <eworkbench-dss-import-option [importOption]="row.import_option"></eworkbench-dss-import-option>
  </ng-template>
  <ng-template #createdAtCellTemplate let-row>
    <div class="whitespace-nowrap">
      {{ row.created_at | formatDate }}
    </div>
  </ng-template>
  <ng-template #createdByCellTemplate let-row>
    <eworkbench-user-details [user]="row.created_by"></eworkbench-user-details>
  </ng-template>
  <ng-template #lastModifiedAtCellTemplate let-row>
    <div class="whitespace-nowrap">
      {{ row.last_modified_at | formatDate }}
    </div>
  </ng-template>
  <ng-template #lastModifiedByCellTemplate let-row>
    <eworkbench-user-details [user]="row.last_modified_by"></eworkbench-user-details>
  </ng-template>
</main>
